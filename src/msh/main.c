/******************************************************************************/
/*                                                                            */
/* src/msh/main.c                                                             */
/*                                                                 2020/08/24 */
/* Copyright (C) 2020 Mochi.                                                  */
/*                                                                            */
/******************************************************************************/
/******************************************************************************/
/* インクルード                                                               */
/******************************************************************************/
/* 標準ヘッダ */
#include <stdbool.h>
#include <string.h>

/* ライブラリヘッダ */
#include <libmk.h>

/* モジュール内ヘッダ */
#include "Clctrl.h"
#include "Termmng.h"


/******************************************************************************/
/* 定義                                                                       */
/******************************************************************************/
/** コマンドラインバッファサイズ */
#define CMD_BUFFER_SIZE ( 1048 )


/******************************************************************************/
/* 静的グローバル変数定義                                                     */
/******************************************************************************/
/** コマンドラインバッファ */
static char gCmd[ CMD_BUFFER_SIZE ];


/******************************************************************************/
/* ローカル関数定義                                                           */
/******************************************************************************/
void main( void )
{
    bool ret;   /* コマンド入力結果 */

    /* 初期化 */
    ret = false;

    /* [TODO] 起動待ち合わせ */
    LibMkTimerSleep( 10000000, NULL );

    /* ターミナル管理初期化 */
    TermmngInit();

    /* コマンドライン制御初期化 */
    ClctrlInit();

    /* 無限ループ */
    while ( true ) {
        /* コマンド入力 */
        ret = ClctrlInput( gCmd, CMD_BUFFER_SIZE );

        /* コマンド入力結果判定 */
        if ( ret != false ) {
            /* 成功 */

            /* [TEST] コマンド出力 */
            TermmngWrite( gCmd, strlen( gCmd ) );
            TermmngWrite( "\r\n", 2 );
        }
    }
}


/******************************************************************************/
